import subprocess

class ExploitExecutor:
    def __init__(self, binary_path):
        self.binary_path = binary_path

    def execute_shellcode(self, shellcode):
        # Exécution du binaire avec le shellcode injecté
        process = subprocess.Popen([self.binary_path], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        # Envoie du shellcode et attente de la sortie
        stdout, stderr = process.communicate(input=shellcode)
        
        # Affichage de la sortie binaire sans tenter de la décoder
        print("Output (raw bytes):", stdout)
        print("Error (raw bytes):", stderr)
        process.wait()
